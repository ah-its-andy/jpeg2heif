version: "3.8"
services:
  jpeg2heif:
    build: .
    image: jpeg2heif:local
    container_name: jpeg2heif
    environment:
      - WATCH_DIRS=/data/images
      - DB_PATH=/data/tasks.db
      - LOG_LEVEL=INFO
      - POLL_INTERVAL=1
      - MAX_WORKERS=4
      - CONVERT_QUALITY=90
      - HTTP_PORT=8000
      - PRESERVE_METADATA=true
      - METADATA_STABILITY_DELAY=1
      - MD5_CHUNK_SIZE=4194304
    volumes:
      - ./sample-data:/data/images:rw
      - ./data:/data:rw
    ports:
      - "8000:8000"
